# Created by Tom
# Created 20230530 
# Script creates base folders for Pentest documentation on Windows conmputer 

# Prompt for the test name
$testName = Read-Host "Enter the test name"

# Get the date of the next Monday
$nextMonday = Get-Date -Hour 0 -Minute 0 -Second 0 -Millisecond 0
while ($nextMonday.DayOfWeek -ne "Monday") {
    $nextMonday = $nextMonday.AddDays(1)
}

# Format the date in the required format (YYYYMMDD)
$dateString = $nextMonday.ToString("yyyyMMdd")

# Define the base path for the folders
$basePath = "C:\Users\bob\Documents\_pentesting\2023"

# Create the main folder with date and test name
$mainFolder = Join-Path -Path $basePath -ChildPath "$dateString-$testName"
New-Item -ItemType Directory -Path $mainFolder

# Create subfolders inside the main folder
$subfolders = @("Reports", "Burp", "NMAP", "Old-Reports", "Emails", "Recon")
foreach ($subfolder in $subfolders) {
    $path = Join-Path -Path $mainFolder -ChildPath $subfolder
    New-Item -ItemType Directory -Path $path
}

# Output the path of the main folder
Write-Host "Main folder created: $mainFolder"
